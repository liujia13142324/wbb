function getValFromSheet(value,obj){if(typeof window.getComputedStyle!="undefined"){value=window.getComputedStyle(obj,null)["height"]}else{if(typeof this.elements[obj].currentStyle!="undefined"){value=this.elements[obj].currentStyle["height"]}}return removePx(value)}function removePx(value){return parseInt(value)}var refresher={lock:1,result:false,isBottom:false,srollEnd:false,info:{"pullUpLable":"上拉加载更多...","pullingUpLable":"温柔的太阳君和他的小伙伴们 微信：a524294514","loadingLable":"Loading...","atBottom":"没了"},init:function(parameter){var inner_obj=document.getElementById("inner_div");var out_obj=document.getElementById("out_div");if($(inner_obj).height()>$(out_obj).height()){var out_height=0;var inner_height=0;var pullUp=document.createElement("div");pullUp.id="pullUp";var loader=document.createElement("div");loader.className="loader";for(var i=0;i<4;i++){var span=document.createElement("span");loader.appendChild(span)}pullUp.appendChild(loader);var pullUpLabel=document.createElement("div");$(pullUpLabel).css("margin-bottom","10px");pullUpLabel.className="pullUpLabel";var content=document.createTextNode(refresher.info.pullUpLable);pullUpLabel.appendChild(content);pullUp.appendChild(pullUpLabel);inner_obj.appendChild(pullUp);var pullUpEl=document.getElementById("pullUp");var pullUpOffset=pullUpEl.offsetHeight;this.scrollIt(parameter,pullUpEl,pullUpOffset,inner_height,out_height,inner_obj,out_obj)}},scrollIt:function(parameter,pullUpEl,pullUpOffset,inner_height,out_height,inner_obj,out_obj){var lastScoll;var scollLock=recordStart=1;var scollCount=0;var scollStartP=0;var isTouch,isTouchStart=false;document.onscroll=function(){if(!refresher.isBottom){refresher.srollEnd=false;refresher.onScrolling(pullUpEl,pullUpOffset,inner_height,out_height,inner_obj,out_obj)}};addEventListener("touchstart",function(e){var touch=e.targetTouches[0];isTouch=true;isTouchStart=true});addEventListener("touchend",function(e){isTouch=false;refresher.onPulling(pullUpEl,parameter.pullUpAction);if(pullUpEl.className.match("loading")){refresher.lock=0;var timer=setInterval(function(){if(refresher.result||refresher.isBottom){refresher.onRelease(pullUpEl);clearInterval(timer);refresher.result=false}},1000)}else{refresher.onRelease(pullUpEl)}})},onScrolling:function(pullUpEl,pullUpOffset,inner_height,out_height,inner_obj,out_obj){inner_height=getValFromSheet(inner_height,inner_obj);out_height=getValFromSheet(out_height,out_obj);if(refresher.lock==1){if(scrollY+out_height<inner_height){pullUpEl.className="";pullUpEl.querySelector(".pullUpLabel").innerHTML=refresher.info.pullUpLable}if(scrollY+out_height>=inner_height){document.getElementById("pullUp").style.display="block";pullUpEl.className="flip";pullUpEl.querySelector(".pullUpLabel").innerHTML=refresher.info.pullingUpLable}}},onPulling:function(pullUpEl,pullUpAction){if(pullUpEl.className.match("flip")){pullUpEl.className="loading";pullUpEl.querySelector(".pullUpLabel").innerHTML=refresher.info.loadingLable;pullUpEl.querySelector(".loader").style.display="block";pullUpEl.style.lineHeight="20px";if(pullUpAction){pullUpAction()}}},onRelease:function(pullUpEl){if(pullUpEl.className.match("loading")){pullUpEl.className="";pullUpEl.querySelector(".pullUpLabel").innerHTML=refresher.info.pullUpLable;pullUpEl.querySelector(".loader").style.display="none";pullUpEl.style.lineHeight=pullUpEl.offsetHeight-44+"px"}refresher.lock=1}};